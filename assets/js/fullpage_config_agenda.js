function isEventSupported(eventName) {    var el = document.createElement('div');    eventName = 'on' + eventName;    var isSupported = (eventName in el);    if (!isSupported) {        el.setAttribute(eventName, 'return;');        isSupported = typeof el[eventName] == 'function';    }    el = null;    return isSupported;}/* Brazilian initialisation for the jQuery UI date picker plugin. */jQuery(function($) {    $.datepicker.regional['pt-BR'] = {        closeText: 'Fechar',        prevText: '&#x3c;Anterior',        nextText: 'Pr&oacute;ximo&#x3e;',        currentText: 'Hoje',        monthNames: ['Janeiro', 'Fevereiro', 'Mar&ccedil;o', 'Abril', 'Maio', 'Junho',            'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'        ],        monthNamesShort: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun',            'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'        ],        dayNames: ['Domingo', 'Segunda-feira', 'Ter&ccedil;a-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sabado'],        dayNamesShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],        dayNamesMin: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab'],        weekHeader: 'Sm',        dateFormat: 'dd/mm/yy',        firstDay: 0,        isRTL: false,        showMonthAfterYear: false,        yearSuffix: ''    };    $.datepicker.setDefaults($.datepicker.regional['pt-BR']);});$(document).ready(function() {    $(function() {        var dateToday = new Date();        $(".volanty_date").datepicker({            dateFormat: 'dd/mm/yy',            minDate: dateToday,            autoclose: true,            regional: 'pt-br'        });    });    $('.fullpage').fullpage({ controlArrows: false });    $('.fullpage').fullpage.setAllowScrolling(false);    $('.fullpage').fullpage.setKeyboardScrolling(false);    // $("html").html("Width:" + screen.width + " | height:" + screen.height);    // VERIFICANDO SE EXISTE PROCESSO ATIVO    if (typeof passo != "undefined") {        $('.fullpage').fullpage.moveTo(1, passo);    }    // SETANDO SCROLL    var wheelEvent = isEventSupported('mousewheel') ? 'mousewheel' : 'wheel';    $('.consulta').on(wheelEvent, function(e) {        var position = $('.consulta .fp-tableCell').scrollTop();        var oEvent = e.originalEvent,            delta = oEvent.deltaY || oEvent.wheelDelta;        if (delta > 0) {            $('.consulta .fp-tableCell').scrollTop(position + 100);        } else {            $('.consulta .fp-tableCell').scrollTop(position - 100);        }    });    /*************      SCRIPT AJAX    **************/    /*---------------    EDIÇÃO 10/09/2019    ADICIONANDO FUNÇÃO     DE BUSCA DE UNIDADE     POR REGIÃO NA     PÁGINA DE CONSULTA    -----------------*/    $("#regioesSobConsulta").on('change', function(event) {        $(this).val();        $.ajax({            type: 'POST',            url: baseurl + 'agenda/buscarUnidadePorRegiao',            cache: false,            headers: { "cache-control": "no-cache" },            data: { 'regiao': $(this).val() },            dataType: 'json',            statusCode: {                404: function() {                    errorMessage("Não foi possível contatar o servidor");                    $('#loader').toggle();                },                500: function() {                    errorMessage("Ocorreu um erro no servidor");                    $('#loader').toggle();                }            },            error: function() {                errorMessage("Não foi possível contatar o servidor");                $('#loader').toggle();            },            success: function(data) {                if (data.resultado == "sucesso") {                    //Time out para abrir o carregando                    $("#unidadesConsulta").html("<option>Buscando unidades...</option>");                    setTimeout(function() {                        $("#unidadesConsulta").html("<option value=''>Unidade</option>");                        for (let index = 0; index < data.lista_lojistas.length; index++) {                            $("#unidadesConsulta").append("<option value='" + data.lista_lojistas[index].cod_lojista + "'>" + data.lista_lojistas[index].endereco + "</option>");                        }                    }, 250);                } else {                    errorMessage("Não existem lojistas nessa região.");                }            }        });    });    /*---------------      SUBMIT: ADMIN    -----------------*/    $("#admLogin").submit(function(event) {        $('#loader').toggle();        event.preventDefault();        $.ajax({            type: 'POST',            url: baseurl + 'Admin/loginInput',            cache: false,            headers: { "cache-control": "no-cache" },            data: $(this).serialize(), // it will serialize the form data            dataType: 'json',            statusCode: {                404: function() {                    errorMessage("Não foi possível contatar o servidor");                    $('#loader').toggle();                },                500: function() {                    errorMessage("Ocorreu um erro no servidor");                    $('#loader').toggle();                }            },            error: function() {                errorMessage("Não foi possível contatar o servidor");                $('#loader').toggle();            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    $('#loader').toggle();                    //Time out para fechar o carregando                    setTimeout(function() {                        if (data.resultado == "sucesso") {                            window.location.href = baseurl + "admin/index";                        } else {                            errorMessage("Não foi possível realizar o login, tente novamente");                        }                    }, 250);                }, 250);            }        }); //Ajax    });    /*---------------      SUBMIT: CONTATO    -----------------*/    $("#mainContato").submit(function(event) {        // $("#pleaseWaitDialog").modal('toggle');        event.preventDefault();        $.ajax({            type: 'POST',            url: baseurl + 'Index/contato',            cache: false,            headers: { "cache-control": "no-cache" },            data: $(this).serialize(), // it will serialize the form data            dataType: 'json',            statusCode: {                404: function(xhr) {                    errorMessage("Não foi possível contatar o servidor");                    // $("#pleaseWaitDialog").modal('toggle');                },                500: function(xhr) {                    errorMessage("Ocorreu um erro no servidor");                    // $("#pleaseWaitDialog").modal('toggle');                }            },            error: function(xhr) {},            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    // $("#pleaseWaitDialog").modal('toggle');                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) { textErr += v + " \n"; });                        if (data.resultado == "sucesso") {                            $('#contatoModal').modal('toggle')                            successMessage("Mensagem enviada com sucesso")                        } else { errorMessage(textErr); }                    }, 250);                }, 250);            }        }); //Ajax    });    /*---------------      SUBMIT: CADASTRO    -----------------*/    $("#mainCadastro").submit(function(event) {        // $("#pleaseWaitDialog").modal('toggle');        event.preventDefault();        form_data = $(this).serializeArray();        $.ajax({            type: 'POST',            url: baseurl + 'Login/inserir',            cache: false,            headers: { "cache-control": "no-cache" },            data: $(this).serialize(), // it will serialize the form data            dataType: 'json',            statusCode: {                404: function(xhr) {                    errorMessage("Não foi possível contatar o servidor");                    // $("#pleaseWaitDialog").modal('toggle');                },                500: function(xhr) {                    errorMessage("Ocorreu um erro no servidor");                    // $("#pleaseWaitDialog").modal('toggle');                }            },            error: function(xhr) {                errorMessage("Ocorreu um erro" + xhr.responseText);                // $("#pleaseWaitDialog").modal('toggle');            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    // $("#pleaseWaitDialog").modal('toggle');                    //Time out para fechar o carregando                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) {                            textErr += v + " \n";                        });                        if (data.resultado == "sucesso") {                            successMessage("Cadastro realizado com sucesso");                            if (window.location.href.indexOf('volanty') != -1) {                                window.location.href = baseurl + 'volanty/agenda';                            } else {                                window.location.href = baseurl + 'agenda';                            }                        } else { errorMessage(textErr); }                    }, 250);                }, 250);            }        }); //Ajax    });    /*---------------      SUBMIT: UNIDADE    -----------------*/    //---INSERT    $('#form_unidade_cad').on('submit', function(e) {        $("#loader").modal('toggle');        e.preventDefault();        $.ajax({            type: "POST",            cache: false,            processData: false,            contentType: false,            url: baseurl + 'Admin/insert',            data: new FormData($('#form_unidade_cad')[0]),            statusCode: {                404: function(xhr) {                    errorMessage("Não foi possível contatar o servidor");                    $("#loader").modal('toggle');                },                500: function(xhr) {                    errorMessage("Ocorreu um erro no servidor");                    $("#loader").modal('toggle');                }            },            error: function(xhr) {                errorMessage("Ocorreu um erro" + xhr.responseText);                $("#loader").modal('toggle');            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    $("#loader").modal('toggle');                    //Time out para fechar o carregando                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) {                            textErr += v + " \n";                        });                        if (data.resultado == "sucesso") {                            if (data.criarContaMoip == "1") {                                var win = window.open(data.setPassword, '_blank');                            } else {                                window.location.href = baseurl + 'Admin';                            }                            successMessage("Operação realizada com sucesso");                            window.location.href = baseurl + 'Admin';                        } else {                            erros = textErr.split('.');                            $('.mensagem-erro').text('');                            for (i in erros) {                                $('.mensagem-erro').append(erros[i] + '<br>');                            }                            $('.mensagem-erro').removeClass('d-none');                            $(window).scrollTop(0);                        }                    }, 250);                }, 250);            }        }); //Ajax    });    //---EDIT    $('#form_unidade_edit').on('submit', function(e) {        $("#loader").modal('toggle');        //var url = $(this).attr('action');        e.preventDefault();        $.ajax({            type: "POST",            cache: false,            processData: false,            contentType: false,            url: baseurl + 'Admin/update',            data: new FormData($('#form_unidade_edit')[0]),            statusCode: {                404: function(xhr) {                    errorMessage("Não foi possível contatar o servidor");                    $("#loader").modal('toggle');                },                500: function(xhr) {                    errorMessage("Ocorreu um erro no servidor");                    $("#loader").modal('toggle');                }            },            error: function(xhr) {                errorMessage("Ocorreu um erro" + xhr.responseText);                $("#loader").modal('toggle');            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    $("#loader").modal('toggle');                    //Time out para fechar o carregando                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) {                            textErr += v + " \n";                        });                        if (data.resultado == "sucesso") {                            window.location.href = baseurl + 'Admin';                            //win.focus();                        } else {                            erros = textErr.split('.');                            $('.mensagem-erro').text('');                            for (i in erros) {                                $('.mensagem-erro').append(erros[i] + '<br>');                            }                            $('.mensagem-erro').removeClass('d-none');                            $(window).scrollTop(0);                        }                    }, 250);                }, 250);            }        }); //Ajax    });    /*---------------      SUBMIT: PERFIL    -----------------*/    $("#mainPerfil").submit(function(event) {        // $("#pleaseWaitDialog").modal('toggle');        event.preventDefault();        //$("#liberar").ajaxForm({url: 'server.php', type: 'post'});  OU        $.ajax({            type: 'POST',            url: baseurl + 'Login/editar',            cache: false,            headers: { "cache-control": "no-cache" },            data: $(this).serialize(), // it will serialize the form data            dataType: 'json',            statusCode: {                404: function(xhr) {                    errorMessage("Não foi possível contatar o servidor");                    // $("#pleaseWaitDialog").modal('toggle');                },                500: function(xhr) {                    errorMessage("Ocorreu um erro no servidor");                    // $("#pleaseWaitDialog").modal('toggle');                }            },            error: function(xhr) {                errorMessage("Ocorreu um erro" + xhr.responseText);                // $("#pleaseWaitDialog").modal('toggle');            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    // $("#pleaseWaitDialog").modal('toggle');                    //Time out para fechar o carregando                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) {                            textErr += v + " \n";                        });                        if (data.resultado == "sucesso") {                            $('#perfilModal').modal('toggle');                            $(".labelEdit").show();                            $(".inputEdit").hide();                            $("#btnPermitirEditarPerfil").show();                            $("#btnSalvarPerfil").hide();                            $("#inputConfirmSenhaEdit").val("");                            $("#inputSenhaEdit").val("");                            $("#TelefoneEditContent").html(data.telefone);                            $("#EmailEditContent").html(data.email);                            $("#NomeEditContent").html(data.nome);                            successMessage("Perfil editado com sucesso.");                        } else {                            errorMessage(textErr);                        }                    }, 250);                }, 250);            }        }); //Ajax    }); //click    /*---------------      SUBMIT: REDEFINIÇÃO      Envia o form da redefinição de senha via ajax tipo post    -----------------*/    $("#redefinirModal").submit(function(event) {        // $("#pleaseWaitDialog").modal('toggle');        event.preventDefault();        $.ajax({            type: 'POST',            url: baseurl + 'Login/redefinir',            cache: false,            headers: { "cache-control": "no-cache" },            data: $(this).serialize(),            dataType: 'json',            statusCode: {                404: function() {                    errorMessage("Não foi possível contatar o servidor");                    // $("#pleaseWaitDialog").modal('toggle');                },                500: function() {                    errorMessage("Ocorreu um erro no servidor");                    // $("#pleaseWaitDialog").modal('toggle');                }            },            error: function(xhr, status, error) {                console.log(xhr.responseText + status + error);                $("body").html('A problem has occurred.');                // $("#pleaseWaitDialog").modal('toggle');            },            success: function(json) {                //Time out para abrir o carregando                setTimeout(function() {                    // $("#pleaseWaitDialog").modal('toggle');                    //Time out para fechar o carregando                    setTimeout(function() {                        //Mostrar mensagem de erro                        if (json.msg.indexOf("não") !== -1) {                            errorMessage(json.msg);                        } else {                            successMessage(json.msg);                        }                        $('#redefinirModal').modal('toggle');                    }, 250);                }, 250);            }        }); //Ajax    });    /*========================================*/    //AGENDA    /*---------------      CHANGE: #1 - VEÍCULOS CADASTRADOS      Seleciona montadora, modelo e motor a partir do item cadastrado selecionado    -----------------*/    $("#SelectCadastrado").on('change', function(event) {        $.ajax({            type: 'POST',            url: baseurl + 'agenda/Cadastrado',            cache: false,            headers: { "cache-control": "no-cache" },            data: { cadastrado: $("#SelectCadastrado").val() },            dataType: 'json',            statusCode: {                404: function() { errorMessage("Não foi possível contatar o servidor"); },                500: function() { errorMessage("Ocorreu um erro no servidor"); }            },            error: function(xhr, status, error) { console.log(xhr.responseText + status + error); },            success: function(json) {                if (json.resultado == "sucesso") {                    // MONTADORAS                    $("#SelectMontadora").html("");                    $("#SelectMontadora").append("<option value=''>Montadora</option>");                    for (var i = json.lista_montadoras.length - 1; i >= 0; i--) {                        $("#SelectMontadora").append("<option " + (json.cadastrado.montadora == json.lista_montadoras[i] ? "selected" : "") + " value='" + json.lista_montadoras[i] + "'>" + json.lista_montadoras[i] + "</option>");                    }                    // MODELOS                    $("#SelectModelo").html("");                    $("#SelectModelo").append("<option value=''>Modelo</option>");                    for (var i = json.lista_modelos.length - 1; i >= 0; i--) {                        $("#SelectModelo").append("<option " + (json.cadastrado.modelo == json.lista_modelos[i] ? "selected" : " ") + " value='" + json.lista_modelos[i] + "'>" + json.lista_modelos[i] + "</option>");                    }                    // MOTORES                    $("#SelectMotor").html("");                    $("#SelectMotor").append("<option value=''>Motor</option>");                    for (var i = json.lista_motores.length - 1; i >= 0; i--) {                        $("#SelectMotor").append("<option " + (json.cadastrado.motor == json.lista_motores[i].motor ? "selected" : " ") + " value='" + json.lista_motores[i].cod_modelo + "'>" + json.lista_motores[i].motor + "</option>");                    }                    //ANO                    $("#ano-veiculo").val(json.cadastrado.ano_cadastrado);                }            }        }); //Ajax    });    /*---------------      CHANGE: #1 - MONTADORAS    -----------------*/    $("#SelectMontadora").on('change', function(event) {        $("#SelectModelo").html("<option>...</option>");        $.ajax({            type: 'POST',            url: baseurl + 'agenda/Modelo',            cache: false,            data: { montadora: $("#SelectMontadora").val() },            dataType: 'json',            async: true,            headers: { "cache-control": "no-cache" },            statusCode: {                404: function() { errorMessage("Não foi possível contatar o servidor"); },                500: function() { errorMessage("Ocorreu um erro no servidor"); }            },            error: function(xhr, status, error) {                console.log(xhr.responseText + status + error);                $("body").html('A problem has occurred.');                // $("#pleaseWaitDialog").modal('toggle');            },            success: function(json) {                if (json.resultado == "sucesso") {                    $("#SelectModelo").html("");                    $("#SelectMotor").html("");                    $("#SelectModelo").append("<option value=''>Modelo</option>");                    $("#SelectMotor").append("<option value=''>Motor</option>");                    for (var i = json.lista.length - 1; i >= 0; i--) {                        $("#SelectModelo").append("<option value='" + json.lista[i] + "'>" + json.lista[i] + "</option>");                    }                }            }        }); //Ajax    });    /*---------------      CHANGE: #1 - MODELO    -----------------*/    $("#SelectModelo").on('change', function(event) {        $("#SelectMotor").html("<option>...</option>");        $.ajax({            type: 'POST',            url: baseurl + 'agenda/Motor',            cache: false,            headers: { "cache-control": "no-cache" },            data: { modelo: $("#SelectModelo").val() },            dataType: 'json',            statusCode: {                404: function() { errorMessage("Não foi possível contatar o servidor"); },                500: function() { errorMessage("Ocorreu um erro no servidor"); }            },            error: function(xhr, status, error) { console.log(xhr.responseText + status + error); },            success: function(json) {                if (json.resultado == "sucesso") {                    $("#SelectMotor").html("");                    $("#SelectMotor").append("<option value=''>Motor</option>");                    for (var i = json.lista.length - 1; i >= 0; i--) {                        $("#SelectMotor").append("<option value='" + json.lista[i]['cod_modelo'] + "'>" + json.lista[i]['motor'] + "</option>");                    }                }            }        }); //Ajax    }); //click    /*---------------      CHANGE: #4 - UNIDADE    -----------------*/    $("#unidadeSelecionada").on('change', function(event) {        $('#periodoSelecionado').val(0);        $("#periodo-1").attr("onclick", "null");        $("#periodo-1").removeClass('active');        $("#periodo-1").removeClass('disabled');        $("#periodo-2").attr("onclick", "null");        $("#periodo-2").removeClass('active');        $("#periodo-2").removeClass('disabled');        $.ajax({            type: 'POST',            url: baseurl + 'agenda/UnidadeRegiao',            cache: false,            headers: { "cache-control": "no-cache" },            data: { unidade: $("#unidadeSelecionada").val() },            dataType: 'json',            statusCode: {                404: function() { errorMessage("Não foi possível contatar o servidor"); },                500: function() { errorMessage("Ocorreu um erro no servidor"); }            },            error: function(xhr, status, error) { console.log(xhr.responseText + status + error); },            success: function(json) {                //Mostrar mensagem de erro                if (json.resultado == "sucesso") {                    if (json.periodo == 1) {                        $("#periodo-1").attr("onclick", "selecionaPeriodo(1); return false;");                        $("#periodo-2").attr("onclick", "null");                        $("#periodo-2").addClass('disabled');                    } else if (json.periodo == 2) {                        $("#periodo-1").attr("onclick", "null");                        $("#periodo-1").addClass('disabled');                        $("#periodo-2").attr("onclick", "selecionaPeriodo(2); return false;");                    } else if (json.periodo == 3) {                        $("#periodo-1").attr("onclick", "selecionaPeriodo(1); return false;");                        $("#periodo-2").attr("onclick", "selecionaPeriodo(2); return false;");                    } else {                        $("#periodo-1").attr("onclick", "null");                        $("#periodo-1").addClass('disabled');                        $("#periodo-2").attr("onclick", "null");                        $("#periodo-2").addClass('disabled');                    }                } else {                    $("#periodo-1").attr("onclick", "null");                    $("#periodo-1").addClass('disabled');                    $("#periodo-2").attr("onclick", "null");                    $("#periodo-2").addClass('disabled');                }            }        }); //Ajax    }); //change    /*---------------      ALTERAÇÃO VOALNTY    -----------------*/    // Ao selecionar plano    $(".passo-2 .card").on('click', function(param) {        if ($(this).hasClass('basico')) {            $(".inter").removeClass('selected');            $(".premium").removeClass('selected');            servico_selected = servico_basico;            $(this).addClass('selected');        }        if ($(this).hasClass('inter')) {            $(".basico").removeClass('selected');            $(".premium").removeClass('selected');            servico_selected = servico_inter;            $(this).addClass('selected');        }        if ($(this).hasClass('premium')) {            $(".basico").removeClass('selected');            $(".inter").removeClass('selected');            servico_selected = servico_premium;            $(this).addClass('selected');        }    });    // Ao selecionar local    $(".passo-3 select").on('change', function(param) {        regiao_selected = $(this).val();    });});/*========================================*//*---------------  FUNCTION: #PASSO 1-----------------*/function Veiculo() {    $('#loader').toggle();    $.ajax({        type: "POST",        cache: false,        headers: { "cache-control": "no-cache" },        data: {            cod_modelo: $("#SelectMotor").val(),            ano_carro: $("#ano-veiculo").val(),            km_carro: $("#km-veiculo").val()        },        dataType: 'json',        url: baseurl + "agenda/veiculo",        statusCode: {            404: function() {                errorMessage('Sem acesso ao servidor.');                $('#loader').toggle();            },            500: function() {                errorMessage('Erro no servidor.');                $('#loader').toggle();            }        },        error: function(xhr, status, error) {            console.log(xhr.responseText + status + error);            errorMessage("A problem has occurred on server side. Contact your administrator");            $('#loader').toggle();        },        success: function(data) {            setTimeout(function() {                setTimeout(function() {                    var textErr = "";                    $.each(data.erros, function(k, v) {                        textErr += v + " \n";                    });                    if (data.resultado == "sucesso") {                        if (data.customizado == 0) {                            $('#loader').toggle();                            $(".basico .price-value span").text("R$" + (data.lista[0].preco / 100));                            $(".inter .price-value span").text("R$" + (data.lista[1].preco / 100));                            $(".premium .price-value span").text("R$" + (data.lista[2].preco / 100));                            servico_basico = data.lista[0].cod_servicos;                            servico_inter = data.lista[1].cod_servicos;                            servico_premium = data.lista[2].cod_servicos;                            // Case sistema volanty                            servico_selected = null;                            // SETANDO SCROLL                            var wheelEvent = isEventSupported('mousewheel') ? 'mousewheel' : 'wheel';                            $('.passo-2').on(wheelEvent, function(e) {                                var position = $('.passo-2 .fp-tableCell').scrollTop();                                var oEvent = e.originalEvent,                                    delta = oEvent.deltaY || oEvent.wheelDelta;                                if (delta > 0) {                                    $('.passo-2 .fp-tableCell').scrollTop(position + 100);                                } else {                                    $('.passo-2 .fp-tableCell').scrollTop(position - 100);                                }                            });                            $(".passo-2 .basico").removeClass('selected');                            $(".passo-2 .inter").removeClass('selected');                            $(".passo-2 .premium").removeClass('selected');                            $('.fullpage').fullpage.moveTo(1, 2);                        } else if (data.customizado == 1) {                            $('#loader').toggle();                        }                    } else {                        erros = textErr.split('.');                        $('.mensagem-erro').text('');                        $('.mensagem-erro').text(erros[0] == 'O campo Código Modelo é obrigatório' ? 'É necessário preencher todas as informações' : erros[0]);                        $('#loader').toggle();                        $('#errorModal').modal('toggle');                    }                }, 250);            }, 250);        }    });}/*---------------    Botão para passar para o slide do sob consulta-----------------*/function toConsulta() {    // SERVIÇO SOB CONSULTA    $('.consulta').removeClass('d-none');    $('.fullpage').fullpage.moveTo(1, 1);}/*---------------  FUNCTION: #PASSO 2 - Sob Consulta-----------------*/function Consulta() {    $('#loader').toggle();    $.ajax({        type: "POST",        cache: false,        headers: { "cache-control": "no-cache" },        data: {            nome: $("#nomeConsulta").val(),            email: $("#emailConsulta").val(),            telefone: $("#telefoneConsulta").val(),            unidade: $("#unidadesConsulta").val(),            data: $("#dataConsulta").val(),            montadora: $("#montadoraConsulta").val(),            modelo: $("#modeloConsulta").val(),            motor: $("#motorConsulta").val(),            ano: $("#anoConsulta").val(),            quilometragem: $("#quilometragemConsulta").val(),            os: getOperationSystem()        },        dataType: 'json',        url: baseurl + "agenda/consulta",        error: function(xhr, status, error) {            errorMessage("Falha ao conectar com o servidor.");            $('#loader').toggle();        },        success: function(data) {            //Time out para abrir o carregando            setTimeout(function() {                setTimeout(function() {                    if (data.resultado == "sucesso") {                        successMessage("Sua consulta foi realizada com sucesso.")                        $('#loader').toggle();                        setTimeout(function() { location.reload(); }, 3000);                    } else {                        errorMessage("Preencha todos os campos.");                        $('#loader').toggle();                    }                }, 250);            }, 250);        }    });}/*---------------  FUNCTION: #PASSO 2-----------------*/function Servico(cod_servico) {    // alert(cod_servico);    $('#loader').toggle();    $('#preco-serv1').html("CARREGANDO");    $('#preco-serv2').html("CARREGANDO");    $('#preco-serv3').html("CARREGANDO");    $.ajax({        type: "POST",        cache: false,        headers: { "cache-control": "no-cache" },        data: { cod_servico: cod_servico, servico_consulta_tipo: $("#servicoSelecionadoConsulta").val() },        dataType: 'json',        url: baseurl + "agenda/servico",        statusCode: {            404: function() {                errorMessage('Could not contact server.');                $('#loader').toggle();            },            500: function() {                errorMessage('A server-side error has occurred.');                $('#loader').toggle();            }        },        error: function(xhr, status, error) {            errorMessage("A problem has occurred on server side. Contact your administrator");            $('#loader').toggle();        },        success: function(data) {            //Time out para abrir o carregando            setTimeout(function() {                //Time out para fechar o carregando                setTimeout(function() {                    if (data.resultado == "sucesso") {                        if (data.servicoConsulta == false) {                            var wheelEvent = isEventSupported('mousewheel') ? 'mousewheel' : 'wheel';                            $('.passo-3').on(wheelEvent, function(e) {                                var position = $('.passo-3 .fp-tableCell').scrollTop();                                var oEvent = e.originalEvent,                                    delta = oEvent.deltaY || oEvent.wheelDelta;                                if (delta > 0) {                                    $('.passo-3 .fp-tableCell').scrollTop(position + 100);                                } else {                                    $('.passo-3 .fp-tableCell').scrollTop(position - 100);                                }                            });                            $('.fullpage').fullpage.moveTo(1, 3);                        } else {                            $('.fullpage').fullpage.moveTo(1, 2);                        }                        $('#loader').toggle();                    } else {                        if (data.errType == 'login') {                            $('#loginModal').modal('toggle');                            $('#loginException').show();                            $('#loader').toggle();                        } else {                            $('#loader').toggle();                            errorMessage("Selecione um plano.");                        }                    }                }, 250);            }, 250);        }    });}/*---------------  FUNCTION: #PASSO 3-----------------*/function Regiao(cod_regiao) {    if ($.isNumeric(cod_regiao)) {        $('#regiaoSelecionado').val(cod_regiao);        $(".passo-3 .card").removeClass("active");        $("#regiao-" + cod_regiao).addClass("active");        $('#loader').toggle();        $.ajax({            type: "POST",            cache: false,            headers: { "cache-control": "no-cache" },            data: { regiao: cod_regiao },            dataType: 'json',            url: baseurl + "agenda/regiao",            statusCode: {                404: function() {                    //$("body").html('Could not contact server.');                    errorMessage('Could not contact server.');                    // $("#pleaseWaitDialog").modal('toggle');                    $('#loader').toggle();                },                500: function() {                    //$("body").html('A server-side error has occurred.');                    errorMessage('A server-side error has occurred.');                    // $("#pleaseWaitDialog").modal('toggle');                    $('#loader').toggle();                }            },            error: function(xhr, status, error) {                console.log(xhr.responseText + status + error);                //$("body").html('A problem has occurred.');                errorMessage("A problem has occurred on server side. Contact your administrator");                // $("#pleaseWaitDialog").modal('toggle');                $('#loader').toggle();            },            success: function(data) {                //Time out para abrir o carregando                setTimeout(function() {                    //Time out para fechar o carregando                    setTimeout(function() {                        if (data.resultado == "sucesso") {                            var wheelEvent = isEventSupported('mousewheel') ? 'mousewheel' : 'wheel';                            $('.passo-4').on(wheelEvent, function(e) {                                var position = $('.passo-2 .fp-tableCell').scrollTop();                                var oEvent = e.originalEvent,                                    delta = oEvent.deltaY || oEvent.wheelDelta;                                if (delta > 0) {                                    $('.passo-4 .fp-tableCell').scrollTop(position + 100);                                } else {                                    $('.passo-4 .fp-tableCell').scrollTop(position - 100);                                }                            });                            $('.fullpage').fullpage.moveSlideRight();                            $('#loader').toggle();                            // UNIDADES                            $("#unidadeSelecionada").html("");                            //$("#product_brand_log").html(brand);                            $("#unidadeSelecionada").append("<option value=''>UNIDADE</option>");                            for (var i = data.listaLojista.length - 1; i >= 0; i--) {                                $("#unidadeSelecionada").append(                                    "<option value='" + data.listaLojista[i]['cod_lojista'] + "'>" + data.listaLojista[i]['nome_unidade'] + "</option>"                                );                            }                            $("#periodo-1").removeClass().addClass("card text-center disabled");                            $("#periodo-1").attr("onclick", "null");                            $("#periodo-2").removeClass().addClass("card text-center disabled");                            $("#periodo-2").attr("onclick", "null");                            $("#periodoSelecionado").val(0);                        } else {                            if (data.errType == 'login') {                                $('#loginModal').modal('toggle');                                $('#loginException').show();                                $('#loader').toggle();                            } else {                                $('#loader').toggle();                                errorMessage(data.msg);                            }                        }                    }, 250);                }, 250);            }        });    } else {        errorMessage("Selecione uma região válida.");    }}/*---------------  FUNCTION: #PASSO 4-----------------*/function Periodo() {    $('#loader').toggle();    $.ajax({        type: "POST",        cache: false,        headers: { "cache-control": "no-cache" },        data: { periodo: $("#periodoSelecionado").val(), unidade: $("#unidadeSelecionada").val(), data: $('#dataPeriodo').val() },        dataType: 'json',        url: baseurl + "agenda/periodo",        statusCode: {            404: function() {                errorMessage('Could not contact server.');                $('#loader').toggle();            },            500: function() {                errorMessage('A server-side error has occurred.');                $('#loader').toggle();            }        },        error: function(xhr, status, error) {            // console.log(xhr.responseText + status + error);            errorMessage("A problem has occurred on server side. Contact your administrator");            $('#loader').toggle();        },        success: function(data) {                        //Time out para abrir o carregando            setTimeout(function() {                //Time out para fechar o carregando                setTimeout(function() {                    if (data.resultado == "sucesso") {                        $('.passo-5 .fp-tableCell').addClass('fp-scroller');                        $('.passo-5 .fp-tableCell').removeClass('.fp-tableCell');                        var wheelEvent = isEventSupported('mousewheel') ? 'mousewheel' : 'wheel';                        $('.passo-5').on(wheelEvent, function(e) {                            var position = $('.passo-5 .fp-tableCell').scrollTop();                            var oEvent = e.originalEvent,                                delta = oEvent.deltaY || oEvent.wheelDelta;                            if (delta > 0) {                                $('.passo-5 .fp-tableCell').scrollTop(position + 100);                            } else {                                $('.passo-5 .fp-tableCell').scrollTop(position - 100);                            }                        });                        $('.fullpage').fullpage.moveSlideRight();                        $('#loader').toggle();                        $('#pag-email').val(" ");                        veiculo = data.modelo.montadora + " " + data.modelo.modelo + " " + data.modelo.motor + " " + "(" + data.modelo.ano + ")";                        unidade = data.unidade.endereco;                        servico = data.servico.nome;                                                                       split = data.data.split('-');                        orderDate = split[2] + '/' + split[1] + '/' + split[0] + (data.periodo == "1" ? " - Matutino" : " - Vespertino");                        total = (data.servico.preco / 100).toFixed(2);                                                $('#tot').html("R$ " +total.toString());                        $('#valor_total').val(total.toString().replace(",", "."));                        $("#paymentVeiculo").html(veiculo);                        $("#paymentLocal").html(unidade);                        $("#paymentServico").html(servico);                        $("#paymentData").html(orderDate);                        $("#valorTotal").html("R$ " + total.toString().replace(".", ","));                    } else {                        if (data.errType == 'login') {                            $('#loginModal').modal('toggle');                            $('#loginException').show();                            $('#loader').toggle();                        } else {                            $('.passo-4 .mensagem-erro').text('');                            if (!(data.msg === undefined)) {                                $('.mensagem-erro').text(data.msg);                            } else {                                if (!(data.erros.periodo === undefined))                                    $('.mensagem-erro').text(data.erros.periodo);                                if (!(data.erros.data === undefined))                                    $('.mensagem-erro').text(data.erros.data);                                if (!(data.erros.unidade === undefined))                                    $('.mensagem-erro').text(data.erros.unidade);                            }                            $('#loader').toggle();                            $('#errorModal').modal('toggle');                        }                    }                  window.location.reload();                  }, 250);            }, 250);                    }    });}/*---------------  FUNCTION: #PASSO 5-----------------*/function Pagamento() {    $('.btn-continuar').attr('disabled', true);    $('.btn-continuar').attr('onclick', " ");    $('.btn-continuar').attr('style', "margin: auto; background-color: #eee");    $('#loader').toggle();    var cc = new Moip.CreditCard({        number: $("#pag-cc-number").val(),        cvc: $("#pag-cc-cvv").val(),        expMonth: $("#pag-cc-expiration").val().split("/")[0],        expYear: $("#pag-cc-expiration").val().split("/")[1],        pubKey: publickey    });    if (cc.isValid()) {        $.ajax({            type: "POST",            cache: false,            data: {                nome: $("#pag-cc-name").val(),                hash: cc.hash(),                installments: $("#pag-installments").val(),                nascimento: $("#pag-nasc").val(),                cpf: $("#pag-cpf").val(),                telefone: $("#pag-tel").val(),                email: $("#pag-email").val(),                os: getOperationSystem()            },            dataType: 'json',            url: baseurl + "agenda/pagamento",            statusCode: {                404: function() {                    errorMessage('Servidor não encontrado.');                    $('#loader').toggle();                },                500: function() {                    errorMessage('Erro ao contatar o servidor.');                    $('#loader').toggle();                }            },            error: function(xhr, status, error) {                // console.log(xhr.responseText + status + error);                errorMessage("Erro ao acessar servidor. Contate o administrador.");                $('#loader').toggle();            },            success: function(data) {                setTimeout(function() {                    setTimeout(function() {                        var textErr = "";                        $.each(data.erros, function(k, v) {                            textErr += v + " \n";                        });                        if (data.resultado == "sucesso") {                            $('.modelo').html(data.veiculo.montadora + " " + data.veiculo.modelo + " " + data.veiculo.motor + " (" + data.veiculo.ano + ")");                            $('.unidade').html(data.unidade.nome_unidade + " - " + data.unidade.endereco);                            $('.data').html(data.data_agenda + (data.periodo == "1" ? " - Matutino" : " - Vespertino"));                            $('.voucher').html(data.voucher);                            $('#loader').toggle();                            $('.fullpage').fullpage.moveSlideRight();                        } else {                            if (data.errType == 'login') {                                $('#loginModal').modal('toggle');                                $('#loginException').show();                                $('#loader').toggle();                            } else {                                $('.mensagem-erro').text('');                                $('.mensagem-erro').text(textErr);                                $('#loader').toggle();                                $('#errorModal').modal('toggle');                            }                            $('.btn-continuar').attr('disabled', false);                            $('.btn-continuar').attr('onclick', "Pagamento(); return false;");                            $('.btn-continuar').attr('style', "margin: auto; background-color: #6afe6f");                        }                    }, 250);                }, 250);            }        });    } else {        $("#encrypted_value").val('');        $("#card_type").val('');        $('.mensagem-erro').text('Cartão de crédito inválido');        $('#errorModal').modal('toggle');        $('.btn-continuar').attr('disabled', false);        $('.btn-continuar').attr('onclick', "Pagamento(); return false;");        $('.btn-continuar').attr('style', "margin: auto; background-color: #6afe6f");        $('#loader').toggle();    }}function getOperationSystem() {    //Converts the user-agent to a lower case string    var userAgent = navigator.userAgent.toLowerCase();    //Fallback in case the operating system can't be identified    var operation_system = "Dispositivo desconhecido";    //Corresponding arrays of user-agent strings and operating systems    match = [        "windows nt 10",        "windows nt 6.3", "windows nt 6.2", "windows nt 6.1", "windows nt 6.0",        "windows nt 5.2", "windows nt 5.1", "windows xp",        "windows nt 5.0", "windows me", "win98", "win95", "win16",        "macintosh", "mac os x", "mac_powerpc",        "android", "linux", "ubuntu",        "iphone", "ipod", "ipad",        "blackberry", "webos"    ];    result = [        "Windows 10",        "Windows 8.1", "Windows 8", "Windows 7", "Windows Vista",        "Windows Server 2003/XP x64", "Windows XP", "Windows XP",        "Windows 2000", "Windows ME", "Windows 98", "Windows 95", "Windows 3.11",        "Mac OS X", "Mac OS X", "Mac OS 9",        "Android", "Linux", "Ubuntu",        "iPhone", "iPod", "iPad",        "BlackBerry", "Mobile"    ];    //For each item in match array    for (var i = 0; i < match.length; i++) {        //If the string is contained within the user-agent then set the os         if (userAgent.indexOf(match[i]) !== -1) {            operation_system = result[i];            break;        }    }    return operation_system;}function Editar() {    $(".labelEdit").hide();    $(".inputEdit").show();    $("#btnPermitirEditarPerfil").hide();    $("#btnSalvarPerfil").show();}function successMessage(message, action = 'toggle') {    $('.mensagem-sucesso').text('');    $('.mensagem-sucesso').text(message);    $('#successModal').modal(action);}function errorMessage(message, action = 'toggle') {    $('.mensagem-erro').text('');    $('.mensagem-erro').text(message);    $('#errorModal').modal(action);}function convertDate(inputFormat) {    function pad(s) { return (s < 10) ? '0' + s : s; }    var d = new Date(inputFormat)    return [pad(d.getDate()), pad(d.getMonth() + 1), d.getFullYear()].join('/')}$(document).ready(function() {    $('#modalPedidos').on('shown.bs.modal', function(e) {        $('#loader').toggle();        if ($('#pedidosListagemAjax').attr('carregado') === 'true') {            $('#pedidosListagemAjax > tbody > tr').remove();        }        $.ajax({            url: 'pedidos',            type: 'post',            dataType: 'json',            data: { 'consulta_ajax': 's' },            success: function(retorno) {                if (retorno.resultado === 'usuario_nao_logado') {                    errorMessage('Usuário não está logado, logue-se e tente novamente');                    $('#modalPedidos').modal('hide');                }                $.each(retorno.lista, function(i, item) {                    var $tr = $('<tr>').append(                        $('<td>').html('<b>' + item.cod_agenda.padStart(6, "0") + '</b>'),                        $('<td>').text(item.unidade),                        $('<td>').text(convertDate(item.data)),                        $('<td>').text(item.status),                        $('<td>').html('<button class="btn btn-sm btn-padrao" onclick="VerPedido(' + item.cod_agenda + ')"><i class="fas fa-eye"></i></button>')                    ).appendTo('#pedidosListagemAjax > tbody');                    $('#loader').hide();                });            },            complete: function() {                $('#pedidosListagemAjax').attr('carregado', 'true');                $('#loader').hide();            }        });    });});function VerPedido(id) {    $('#loader').show();    var formatar_numeros = new Intl.NumberFormat({ maximumSignificantDigits: 3 }).format;    $.ajax({        url: 'detalhesPedido/' + id,        type: 'post',        dataType: 'json',        data: { cod_pedido: id },        success: function(retorno) {            $('table#pedidosListagemAjax').hide();            $('table#pedidoDetalhe').show();            $('#detalheIdPedido').html('<h2>Pedido ' + retorno.pedido.cod_agenda.padStart(6, "0") + '</h2>');            $('td#detalheValorUnidade').html(retorno.pedido.unidade);            $('td#detalheEndereco').html(retorno.pedido.endereco);            $('td#detalheData').html(convertDate(retorno.pedido.data));            $('td#detalheModelo').html(retorno.pedido.modelo.montadora + ' ' + retorno.pedido.modelo.modelo + ' ' + retorno.pedido.modelo.motor + ((retorno.pedido.ano_carro != null) ? ' - ' + retorno.pedido.ano_carro : ''));            $('td#detalheServico').html(retorno.pedido.servico.nome);            $('td#detalhePreco').html('R$ ' + retorno.pedido.servico.preco);            $('td#detalheVoucher').html(retorno.pedido.voucher);            $('td#detalheKMRodado').html(formatar_numeros(retorno.pedido.km_carro) + 'KM');            $('td#detalheStatus').html(retorno.pedido.status);        },        complete: function() {            $('#loader').hide();        }    });}function btnVoltarPedidosListagem(botao) {    $('table#pedidosListagemAjax').show();    $('table#pedidoDetalhe').hide();}